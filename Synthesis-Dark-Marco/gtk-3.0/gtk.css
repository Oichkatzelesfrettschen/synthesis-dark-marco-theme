/**
 * Synthesis Dark GTK3 Theme
 * 
 * A modern dark theme combining:
 * - Dracula color palette (backgrounds)
 * - Catppuccin Mocha (accents)
 * - CachyOS teal (#17b169)
 * 
 * Accessibility: WCAG AAA compliant (13.5:1 contrast for primary text)
 * Design principles: Colin Ware's visual perception theory
 */

/* === Color Definitions === */
@define-color theme_bg_color #232530;
@define-color theme_fg_color #f4f4f5;
@define-color theme_base_color #1e1e2e;
@define-color theme_text_color #f4f4f5;
@define-color theme_selected_bg_color #17b169;
@define-color theme_selected_fg_color #232530;

/* Insensitive (disabled) states */
@define-color insensitive_bg_color #1e1e2e;
@define-color insensitive_fg_color #6c7086;
@define-color insensitive_base_color #181825;

/* Borders */
@define-color borders #44475a;
@define-color unfocused_borders #383a4a;

/* Accent colors - CachyOS and Catppuccin */
@define-color accent_teal #17b169;
@define-color accent_red #f38ba8;
@define-color accent_yellow #f9e2af;
@define-color accent_blue #89b4fa;
@define-color accent_green #a6e3a1;
@define-color accent_purple #cba6f7;

/* Button colors */
@define-color button_bg #313244;
@define-color button_hover_bg #3e4153;
@define-color button_active_bg #17b169;

/* Link colors */
@define-color link_color #89dceb;
@define-color link_visited_color #b4befe;

/* Warning/Error colors */
@define-color warning_color #f9e2af;
@define-color error_color #f38ba8;
@define-color success_color #a6e3a1;

/* Shadows and depth */
@define-color shadow_color rgba(0, 0, 0, 0.25);

/* === Global Resets === */
* {
    padding: 0;
    -gtk-icon-style: symbolic;
}

/* Focus indicators - visible by default for accessibility */
*:focus {
    outline-color: alpha(@accent_teal, 0.5);
    outline-style: solid;
    outline-width: 2px;
    outline-offset: -2px;
    -gtk-outline-radius: 3px;
}

/* === Base Window === */
window {
    background-color: @theme_bg_color;
    color: @theme_fg_color;
}

window.background {
    background-color: @theme_bg_color;
}

window.csd {
    border-radius: 12px;
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15),
                0 4px 8px rgba(0, 0, 0, 0.25),
                0 0 1px rgba(0, 0, 0, 0.5);
}

/* === Buttons === */
button {
    min-height: 24px;
    min-width: 16px;
    padding: 4px 12px;
    border-radius: 3px;
    background-color: @button_bg;
    background-image: linear-gradient(to bottom,
        alpha(white, 0.05),
        alpha(black, 0.02)
    );
    border: 1px solid @borders;
    color: @theme_fg_color;
    transition: all 200ms cubic-bezier(0.25, 0.46, 0.45, 0.94);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

button:hover {
    background-color: @button_hover_bg;
    background-image: linear-gradient(to bottom,
        alpha(white, 0.08),
        alpha(black, 0.02)
    );
    border-color: alpha(@accent_teal, 0.5);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
}

button:active,
button:checked {
    background-color: @button_active_bg;
    background-image: none;
    color: @theme_selected_fg_color;
    border-color: @accent_teal;
    box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.2);
}

button:disabled {
    background-color: @insensitive_bg_color;
    color: @insensitive_fg_color;
    border-color: @unfocused_borders;
    box-shadow: none;
    opacity: 0.5;
}

button.flat {
    background-color: transparent;
    background-image: none;
    border-color: transparent;
    box-shadow: none;
}

button.suggested-action {
    background-color: @accent_teal;
    color: @theme_selected_fg_color;
    border-color: shade(@accent_teal, 0.8);
}

button.suggested-action:hover {
    background-color: shade(@accent_teal, 1.1);
}

button.destructive-action {
    background-color: @accent_red;
    color: white;
    border-color: shade(@accent_red, 0.8);
}

button.destructive-action:hover {
    background-color: shade(@accent_red, 1.1);
}

/* === Entries (Text inputs) === */
entry {
    min-height: 32px;
    padding: 5px 8px;
    border-radius: 3px;
    background-color: @theme_base_color;
    color: @theme_text_color;
    border: 1px solid @borders;
    transition: all 200ms;
    box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
}

entry:focus {
    border-color: @accent_teal;
    box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1),
                0 0 0 1px alpha(@accent_teal, 0.3);
}

entry:disabled {
    background-color: @insensitive_base_color;
    color: @insensitive_fg_color;
    border-color: @unfocused_borders;
}

entry.error {
    border-color: @error_color;
    color: @error_color;
}

entry.warning {
    border-color: @warning_color;
}

/* Entry placeholder text */
entry placeholder {
    color: @insensitive_fg_color;
}

/* === Check and Radio Buttons === */
checkbutton,
radiobutton {
    padding: 2px;
}

checkbutton check,
radiobutton radio {
    min-width: 16px;
    min-height: 16px;
    margin: 0 4px;
    border-radius: 3px;
    background-color: @theme_base_color;
    border: 1px solid @borders;
}

radiobutton radio {
    border-radius: 50%;
}

checkbutton check:checked,
radiobutton radio:checked {
    background-color: @accent_teal;
    border-color: @accent_teal;
    color: @theme_selected_fg_color;
    -gtk-icon-source: -gtk-icontheme("object-select-symbolic");
}

checkbutton check:disabled,
radiobutton radio:disabled {
    background-color: @insensitive_bg_color;
    border-color: @unfocused_borders;
}

/* === Switches === */
switch {
    min-width: 44px;
    min-height: 24px;
    border-radius: 12px;
    background-color: @theme_base_color;
    border: 1px solid @borders;
}

switch:checked {
    background-color: @accent_teal;
    border-color: @accent_teal;
}

switch slider {
    min-width: 20px;
    min-height: 20px;
    margin: 2px;
    border-radius: 50%;
    background-color: @theme_fg_color;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

/* === Notebook (Tabs) === */
notebook {
    background-color: @theme_bg_color;
}

notebook > header {
    background-color: shade(@theme_bg_color, 0.95);
    border-bottom: 1px solid @borders;
}

notebook > header > tabs > tab {
    min-height: 30px;
    min-width: 60px;
    padding: 4px 12px;
    border: 1px solid transparent;
    background-color: transparent;
    color: @insensitive_fg_color;
}

notebook > header > tabs > tab:hover {
    background-color: alpha(white, 0.05);
    color: @theme_fg_color;
}

notebook > header > tabs > tab:checked {
    background-color: @theme_bg_color;
    color: @theme_fg_color;
    border-color: @borders;
    border-bottom-color: transparent;
}

/* === Scrollbars === */
scrollbar {
    background-color: transparent;
}

scrollbar slider {
    min-width: 12px;
    min-height: 12px;
    margin: 2px;
    border-radius: 6px;
    background-color: alpha(@theme_fg_color, 0.3);
    transition: all 200ms;
}

scrollbar slider:hover {
    background-color: alpha(@accent_teal, 0.7);
}

scrollbar slider:active {
    background-color: @accent_teal;
}

scrollbar.horizontal slider {
    min-width: 40px;
}

scrollbar.vertical slider {
    min-height: 40px;
}

/* === Progress bars === */
progressbar {
    font-size: smaller;
    color: @theme_fg_color;
}

progressbar trough {
    min-height: 14px;
    border-radius: 3px;
    background-color: @theme_base_color;
    border: 1px solid @borders;
}

progressbar progress {
    min-height: 14px;
    border-radius: 3px;
    background-image: linear-gradient(to right,
        @accent_teal,
        shade(@accent_teal, 1.2)
    );
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

/* === Scales (Sliders) === */
scale {
    min-height: 16px;
    min-width: 16px;
}

scale trough {
    min-height: 4px;
    min-width: 4px;
    border-radius: 3px;
    background-color: @theme_base_color;
    border: 1px solid @borders;
}

scale highlight {
    background-color: @accent_teal;
    border-radius: 3px;
}

scale slider {
    min-width: 16px;
    min-height: 16px;
    margin: -6px;
    border-radius: 50%;
    background-color: @theme_fg_color;
    border: 2px solid @accent_teal;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

scale slider:hover {
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
}

scale slider:active {
    background-color: @accent_teal;
}

/* === Menus === */
menubar {
    background-color: @theme_bg_color;
    border-bottom: 1px solid @borders;
    padding: 2px;
}

menubar > menuitem {
    min-height: 20px;
    padding: 4px 8px;
    border-radius: 3px;
}

menubar > menuitem:hover {
    background-color: alpha(white, 0.1);
}

menu {
    margin: 4px;
    padding: 4px;
    border-radius: 3px;
    background-color: @theme_bg_color;
    border: 1px solid @borders;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

menu menuitem {
    min-height: 20px;
    padding: 6px 12px;
    border-radius: 3px;
}

menu menuitem:hover {
    background-color: @theme_selected_bg_color;
    color: @theme_selected_fg_color;
}

menu separator {
    min-height: 1px;
    margin: 4px 0;
    background-color: @borders;
}

/* === Toolbars === */
toolbar {
    padding: 4px;
    background-color: @theme_bg_color;
    border-bottom: 1px solid @borders;
}

toolbar separator {
    min-width: 1px;
    min-height: 1px;
    margin: 4px;
    background-color: @borders;
}

/* === Popovers === */
popover {
    padding: 4px;
    border-radius: 6px;
    background-color: @theme_bg_color;
    border: 1px solid @borders;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

popover > contents {
    padding: 8px;
}

/* === Tooltips === */
tooltip {
    padding: 6px 10px;
    border-radius: 3px;
    background-color: @theme_base_color;
    color: @theme_fg_color;
    border: 1px solid @borders;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
}

tooltip * {
    background-color: transparent;
    color: inherit;
}

/* === Spinbuttons === */
spinbutton {
    border-radius: 3px;
    background-color: @theme_base_color;
    border: 1px solid @borders;
}

spinbutton button {
    background-color: transparent;
    border: none;
    box-shadow: none;
}

spinbutton button:hover {
    background-color: alpha(white, 0.05);
}

/* === Combo boxes === */
combobox button {
    min-width: 16px;
}

combobox arrow {
    min-height: 16px;
    min-width: 16px;
}

/* === Lists and Trees === */
treeview {
    background-color: @theme_base_color;
    color: @theme_text_color;
    border: 1px solid @borders;
}

treeview:selected {
    background-color: @theme_selected_bg_color;
    color: @theme_selected_fg_color;
}

treeview header button {
    padding: 4px 6px;
    background-color: shade(@theme_bg_color, 0.95);
    border: 1px solid @borders;
    border-radius: 0;
}

treeview header button:hover {
    background-color: alpha(white, 0.05);
}

/* === Frames === */
frame > border {
    border: 1px solid @borders;
    border-radius: 3px;
}

frame > label {
    padding: 2px;
    color: @theme_fg_color;
}

/* === Separators === */
separator {
    background-color: @borders;
    min-width: 1px;
    min-height: 1px;
}

/* === Links === */
link,
*:link {
    color: @link_color;
}

link:visited,
*:visited {
    color: @link_visited_color;
}

link:hover,
*:link:hover {
    color: shade(@link_color, 1.2);
    text-decoration: underline;
}

/* === Labels === */
label {
    color: @theme_fg_color;
}

label:disabled {
    color: @insensitive_fg_color;
}

/* === Levelbar === */
levelbar block {
    min-width: 32px;
    min-height: 6px;
    border-radius: 3px;
}

levelbar block.filled {
    background-color: @accent_teal;
}

levelbar block.empty {
    background-color: @theme_base_color;
    border: 1px solid @borders;
}

levelbar block.high {
    background-color: @success_color;
}

levelbar block.low {
    background-color: @warning_color;
}

levelbar block.full {
    background-color: @error_color;
}

/* === Spinners === */
spinner {
    opacity: 0;
    -gtk-icon-source: -gtk-icontheme("process-working-symbolic");
}

spinner:checked {
    opacity: 1;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    to { -gtk-icon-transform: rotate(1turn); }
}

/* === Scrolled Window === */
scrolledwindow {
    background-color: @theme_base_color;
}

scrolledwindow > overshoot.top,
scrolledwindow > overshoot.bottom,
scrolledwindow > overshoot.left,
scrolledwindow > overshoot.right {
    background-image: none;
}

/* === Calendar === */
calendar {
    padding: 4px;
    background-color: @theme_bg_color;
    color: @theme_fg_color;
}

calendar:selected {
    background-color: @theme_selected_bg_color;
    color: @theme_selected_fg_color;
    border-radius: 3px;
}

/* === Infobar === */
infobar {
    border: none;
    padding: 8px;
}

infobar.info {
    background-color: @accent_blue;
    color: @theme_bg_color;
}

infobar.warning {
    background-color: @warning_color;
    color: @theme_bg_color;
}

infobar.error {
    background-color: @error_color;
    color: white;
}

infobar.question {
    background-color: @accent_purple;
    color: white;
}

/* === Headerbar (GNOME/GTK CSD) === */
headerbar {
    min-height: 40px;
    padding: 0 6px;
    background-image: linear-gradient(to bottom,
        @theme_bg_color,
        shade(@theme_bg_color, 0.95)
    );
    color: @theme_fg_color;
    border-bottom: 1px solid @borders;
    border-top-left-radius: 12px;
    border-top-right-radius: 12px;
    box-shadow: inset 0 1px alpha(white, 0.05);
}

headerbar:backdrop {
    opacity: 0.9;
}

headerbar button {
    margin: 4px 2px;
}

headerbar .title {
    font-weight: bold;
    padding: 0 12px;
}

headerbar .subtitle {
    font-size: smaller;
    padding: 0 12px;
    opacity: 0.7;
}

/* === Application-specific === */

/* Nautilus / Files */
.nautilus-window notebook {
    background-color: @theme_base_color;
}

/* Terminal */
terminal-window notebook header {
    background-color: @theme_bg_color;
}

/* Text Editor */
.gedit-document-panel {
    background-color: @theme_bg_color;
}

/* === Dark theme compatibility === */
@define-color dark_bg_color @theme_bg_color;
@define-color dark_fg_color @theme_fg_color;

/* === Legacy GTK2 compatibility === */
@define-color bg_color @theme_bg_color;
@define-color fg_color @theme_fg_color;
@define-color base_color @theme_base_color;
@define-color text_color @theme_text_color;
@define-color selected_bg_color @theme_selected_bg_color;
@define-color selected_fg_color @theme_selected_fg_color;
